(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{3325:(e,t,a)=>{"use strict";a.d(t,{default:()=>A});var i=a(5155),l=a(2717),r=a(6999),n=a(63),s=a(2115);function c(e){return(0,i.jsx)("div",{ref:e.ref,onClick:()=>{e.onClick&&e.onClick()},className:"w-full h-full".concat(e.className?" "+e.className:""),"data-value":e.value,children:e.children})}let o={src:"/_next/static/media/icon-open.b2136be6.svg",height:16,width:16,blurWidth:0,blurHeight:0};var u=a(5239);function d(e){let[t,a]=(0,s.useState)(e.initial),[l,r]=(0,s.useState)(!1),n=(0,s.useRef)(0),d=(0,s.useRef)(null);return(0,s.useEffect)(()=>{var e;n.current=(null==(e=d.current)?void 0:e.clientHeight)||0},[t]),(0,s.useEffect)(()=>{a(e.initial)},[e.initial]),(0,i.jsxs)("div",{className:"w-full h-full bg-red-500 relative ".concat(l?"overflow-visible":"overflow-hidden").concat(e.className?" "+e.className:""),children:[(0,i.jsx)(u.default,{src:o,alt:"icon-open",width:16,height:16,className:"absolute z-10 top-3 right-4"}),(0,i.jsx)("div",{className:"w-full h-fit absolute z-10 left-0".concat(e.windowClassName?" "+e.windowClassName:""),style:{top:"".concat(l?0:-(t*n.current*1),"px")},children:e.children.map((t,s)=>{let o=t.props["data-value"]||s.toString();return(0,i.jsx)(c,{ref:d,onClick:()=>{var t;l?(0===n.current&&(n.current=(null==(t=d.current)?void 0:t.clientHeight)||0),a(()=>s),r(e=>!e)):r(e=>!e),e.onSelect&&e.onSelect(o)},value:o,children:t},s)})})]})}function h(e){return(0,i.jsx)("svg",{className:"transition-all duration-250 parabola".concat(e.opened?" rotate-180":""),width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M15 6L9 12L3 6",stroke:e.opened?"#4295E4":"#938A9F",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}function x(e){var t;let[a,l]=(0,s.useState)(!1),r=(0,s.useRef)(null);return(0,i.jsxs)("div",{ref:r,className:"w-full h-auto flex flex-col gap-4 overflow-hidden",children:[(0,i.jsxs)("div",{className:"w-full flex justify-between items-center py-[3px] cursor-pointer",onClick:()=>{l(e=>!e)},children:[(0,i.jsx)("p",{className:"text-base font-medium leading-[26px]",children:e.name}),(0,i.jsx)(h,{opened:a})]}),(0,i.jsx)("div",{className:"w-full h-fit transition-all duration-1000 linear flex flex-col gap-[6px]",style:{maxHeight:a?"".concat(e.maxHeight||(null==(t=r.current)?void 0:t.scrollHeight),"px"):"0px"},children:e.children})]})}var m=a(9181);function p(e){let[t,a]=(0,s.useState)(e.active);return(0,s.useEffect)(()=>{a(e.active)},[e.active]),(0,i.jsxs)("div",{onClick:function(){e.onCheck(!t),a(e=>!e)},className:"w-full flex gap-8 items-start h-fit cursor-pointer justify-between",children:[(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("div",{className:"pt-[3px] w-4 h-4",children:(0,i.jsx)(m.A,{checked:t,className:"w-full h-full"})}),(0,i.jsx)("p",{className:"max-w-[184px] h-fit text-sm font-normal leading-6",children:e.name})]}),(0,i.jsxs)("p",{className:"text-xs font-thin leading-6 text-gray",children:["(",e.quantity,")"]})]})}function f(e){var t,a;let l="[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none";return null==(t=e.inputSettings)||t.min,null==(a=e.inputSettings)||a.max,(0,i.jsx)("input",{ref:e.ref,onInput:function(){var t;e.onInput&&e.onInput(null==(t=e.ref.current)?void 0:t.value)},className:e.className?e.className+" "+l:l,type:"number",inputMode:"numeric"})}function g(e){return(0,i.jsx)("div",{className:"w-full h-full flex items-center justify-center px-[10px] relative".concat(e.className?" "+e.className:""),children:(0,i.jsxs)("div",{className:"w-fit! h-fit min-w-4 flex items-center justify-center",children:[(0,i.jsx)(f,{ref:e.ref,delay:e.delay,onInput:t=>{e.onInput(t)},inputSettings:e.inputSettings,className:"w-[52px] border-0 outline-0 h-fit text-sm font-regular leading-6"}),(0,i.jsx)("p",{children:e.placeholder})]})})}var v=a(309);function j(e){let[t,a]=(0,s.useState)([e.min,e.max]),l=(0,s.useRef)(void 0),r=(0,s.useRef)(null),n=(0,s.useRef)(null);function c(t){e.onChange(t)}function o(i,s){clearTimeout(l.current),l.current=setTimeout(()=>{if("min"===s){if(parseFloat(i)>parseFloat(n.current.value)){r.current.value=n.current.value,a([parseFloat(n.current.value),t[1]]);return}if(parseFloat(i)<e.min||""===i){r.current.value=e.min.toString(),a([e.min,t[1]]);return}a([parseFloat(i),t[1]])}if("max"===s){if(parseFloat(i)<parseFloat(r.current.value)){n.current.value=r.current.value,a([t[0],parseFloat(r.current.value)]);return}if(parseFloat(i)>e.max||""===i){n.current.value=e.max.toString(),a([t[0],e.max]);return}a([t[0],parseFloat(i)])}c({min:r.current.value,max:n.current.value})},750)}return(0,s.useEffect)(()=>{r.current.value=e.min.toString(),n.current.value=e.max.toString()},[]),(0,s.useEffect)(()=>{void 0!==e.value[0]&&void 0!==e.value[1]?(a([e.value[0],e.value[1]]),r.current.value=e.value[0].toString(),n.current.value=e.value[1].toString()):(a([e.min,e.max]),r.current.value=e.min.toString(),n.current.value=e.max.toString())},[e.value]),(0,i.jsxs)("div",{className:"w-full flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"w-full grid grid-cols-2 grid-rows-[44px]",children:[(0,i.jsx)(g,{ref:r,delay:750,inputSettings:{min:e.min,max:e.max},onInput:e=>{o(e,"min")},placeholder:e.placeholder}),(0,i.jsx)(g,{ref:n,delay:750,inputSettings:{min:e.min,max:e.max},onInput:e=>{o(e,"max")},placeholder:e.placeholder})]}),(0,i.jsx)("div",{className:"px-[12px]",children:(0,i.jsx)(v.Ay,{min:e.min,max:e.max,step:1,value:t,onChange:function(e,t){a(t);let i=t[0].toString(),s=t[1].toString();r.current.value=i,n.current.value=s,clearTimeout(l.current),l.current=setTimeout(()=>{c({min:i,max:s})},750)}})})]})}var w=a(6397);let b={src:"/_next/static/media/icon-mark.35fb8f3d.svg",height:20,width:20,blurWidth:0,blurHeight:0},N={src:"/_next/static/media/icon-gift.3a02e793.svg",height:12,width:12,blurWidth:0,blurHeight:0};function k(e){return(0,i.jsxs)("div",{className:"w-full h-fit flex flex-col items-center 550:items-start cursor-pointer relative",children:[(0,i.jsx)("div",{className:"w-fit h-fit py-4 px-[10px] absolute top-3 right-[14px] ".concat(0===e.product.discount&&"hidden"),children:(0,i.jsx)("p",{className:"text-xs font-medium",children:"SALE"})}),(0,i.jsxs)("div",{className:"w-fit h-fit flex flex-col gap-[10px] absolute left-3 top-[17px]",children:[(0,i.jsxs)("div",{className:"py-[2.5px] px-2 pl-0 flex gap-2 items-center bg-white",children:[(0,i.jsx)(u.default,{src:b,width:20,height:20,alt:"icon-mark"}),(0,i.jsx)("p",{className:"text-sm font-normal leading-6 text-gray",children:"В наличии"})]}),(0,i.jsxs)("div",{className:"px-2 py-[6px] flex gap-[10px] items-center w-fit h-fit bg-white",children:[(0,i.jsx)(u.default,{src:N,width:12,height:12,alt:"icon-mark"}),(0,i.jsx)("p",{className:"text-xs font-normal",children:"Подарок"})]})]}),(0,i.jsx)(u.default,{src:"/api/cdn/".concat(e.product.poster),alt:e.product.name,width:288,height:320,style:{aspectRatio:"288/320"},className:"object-contain object-center"}),(0,i.jsxs)("div",{className:"w-full py-[10px] px-3 flex flex-col",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(w.A,{name:"rating",defaultValue:0!==e.product.rates?e.product.rating/e.product.rates:0,precision:.5,readOnly:!0}),(0,i.jsxs)("p",{className:"text-[13px] font-normal text-gray leading-[21px]",children:["(",e.product.reviewsCount,") отзывов"]})]}),(0,i.jsx)("p",{className:"text-sm 850:text-base font-normal leading-6 850:leading-[26px] text-gray max-w-full",children:e.product.name}),(0,i.jsx)("div",{className:"h-fit flex gap-3 items-center",children:0!==e.product.discount?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:"text-lg 850:text-xl font-semibold",children:[e.product.price-e.product.price*(e.product.discount/100),"₽"]}),(0,i.jsxs)("p",{className:"text-base 850:text-lg font-light text-gray line-through",children:[e.product.price,"₽"]})]}):(0,i.jsxs)("p",{className:"text-lg 850:text-xl font-semibold",children:[e.product.price,"₽"]})})]})]})}var y=a(7018);let S={src:"/_next/static/media/icon-close.4a60ccc1.svg",height:14,width:14,blurWidth:0,blurHeight:0},C={src:"/_next/static/media/icon-arrow-back.3e968174.svg",height:20,width:20,blurWidth:0,blurHeight:0};var _=a(2619),H=a.n(_);function A(e){var t,a,c,o,u,h,m,f,g,v,w,b,N,_;let[A,P]=(0,s.useState)(e.products),[W,E]=(0,s.useState)({}),[F,R]=(0,s.useState)(e.maxPages),[T,z]=(0,s.useState)(!1),O=(0,s.useRef)(null),I=(0,n.useSearchParams)(),L=(0,n.useRouter)();async function q(){let t=new URLSearchParams(O.current).toString(),{products:a,quantity:i}=await fetch("/api/proxy/products?cid=".concat(e.cid,"&").concat(t)).then(e=>e.json());R(Math.ceil(i/12)),P(a)}function M(t,a){function i(e,t,a){if(!1===e&&!1===t){delete O.current["min".concat(a)],delete O.current["max".concat(a)];return}O.current["min".concat(a)]=e.toString(),O.current["max".concat(a)]=t.toString()}function l(e,t,a){if(t){let t;t=Array.isArray(O.current[a])?O.current[a]:[],O.current[a]=[...t,e]}else!function(e,t){let a=O.current[t]||[];if(0!==a.length){if(1===a.length){O.current[t]=[];return}O.current[t]=a.filter(t=>t!==e)}}(e,a)}switch(delete O.current.page,a){case"sort":{let e=I.get("sort"),a=t.sort;if(!e&&"popular"===a||e===a)return;O.current.sort=a;break}case"page":{let e=t.page;O.current.page=e;break}case"price":i(t.min,t.max,"Price");break;case"height":i(t.min,t.max,"Height");break;case"width":i(t.min,t.max,"Width");break;case"thickness":i(t.min,t.max,"Thickness");break;case"features":l(t.name,t.value,"features");break;case"colors":l(t.name,t.value,"colors");break;case"material":l(t.name,t.value,"material")}let r=[];for(let e in O.current){switch("sort"===e?"sort":"page"===e?"page":["minPrice","maxPrice","minWidth","maxWidth","minHeight","maxHeight","minThickness","maxThickness"].includes(e)?"range":["features","colors","material"].includes(e)?"array":void 0){case"sort":r.push("sort=".concat(O.current.sort));break;case"page":r.push("page=".concat(O.current.page));case"array":Array.isArray(O.current[e])&&0!==O.current[e].length&&r.push("".concat(e,"=").concat(O.current[e].join(",")));break;case"range":r.push("".concat(e,"=").concat(O.current[e]))}}let n=r.join("&");L.push("/catalog/products/".concat(e.cid,"?").concat(n))}function B(){E(e=>({...e,page:1})),L.push("/catalog/products/".concat(e.cid))}return(0,s.useEffect)(()=>{O.current=Object.fromEntries(Array.from(I.entries()).map(e=>{let[t,a]=e;return[t,a.includes(",")?a.split(","):[a]]})),0!==Object.keys(O.current).length?q():P(e.products),E(O.current)},[I]),(0,i.jsxs)("div",{className:"mt-8 h-auto grid gap-x-[30px] gap-y-8     1300:px-25     1230:px-15     1100:px-8     px-4     850:grid-cols-[288px_1fr]     800:grid-cols-[230px_1fr] 800:grid-rows-[min-content_auto]     grid-cols-1 grid-rows-[50px_40px_auto]",children:[(0,i.jsx)(l.A,{onClick:B,className:"bg-white border-1 border-light-blue text-black! w-full hidden 800:block",children:"Сбросить фильтры"}),(0,i.jsx)(l.A,{onClick:()=>{z(e=>!e)},className:"w-full block 800:hidden",children:"Фильтр"}),(0,i.jsxs)("div",{className:"flex gap-[30px]",children:[(0,i.jsx)("div",{className:"w-full max-w-full hidden 800:flex flex-wrap gap-4",children:function(){function e(e,t,a,l,n){return(0,i.jsxs)("div",{className:"h-10 w-fit flex items-center gap-2",children:[a,": ",W[e],l,"-",W[t],l,(0,i.jsx)(r.A,{onClick:function(){M({min:!1,max:!1},n)},src:S,width:14,height:14,alt:"icon-close"})]},"".concat(a))}function t(e,t){return e.map((e,a)=>(0,i.jsxs)("div",{className:"h-10 w-fit flex items-center gap-2",children:[e,(0,i.jsx)(r.A,{src:S,width:14,height:14,alt:"icon-close"})]},"".concat(t,"-").concat(a)))}return Object.keys(W).flatMap(a=>"minPrice"===a?e("minPrice","maxPrice","Цена","₽","price"):"features"===a?t(W.features,"features"):"colors"===a?t(W.colors,"colors"):"material"===a?t(W.material,"material"):"minHeight"===a?e("minHeight","maxHeight","Высота","мм","height"):"minWidth"===a?e("minWidth","maxWidth","Ширина","мм","width"):"minThickness"===a?e("minThickness","maxThickness","Толщина","мм","thickness"):void 0)}()}),(0,i.jsx)("div",{className:"w-full 800:w-71 min-w-71 h-10",children:(0,i.jsxs)(d,{onSelect:e=>{M({sort:e},"sort")},initial:function(){let e=["popular","new","old","price_asc","price_desc"].indexOf(W.sort?W.sort[0]:"popular");return -1===e?0:e}(),className:"border-b-1 border-t-1 border-light-gray cursor-pointer",windowClassName:"border-1 border-t-0 border-light-gray",children:[(0,i.jsx)("div",{"data-value":"popular",className:"bg-white w-full h-10 pt-[7px] px-4",children:"Популярные"}),(0,i.jsx)("div",{"data-value":"new",className:"bg-white w-full h-10 pt-[7px] px-4",children:"Новые"}),(0,i.jsx)("div",{"data-value":"old",className:"bg-white w-full h-10 pt-[7px] px-4",children:"Старые"}),(0,i.jsx)("div",{"data-value":"price_asc",className:"bg-white w-full h-10 pt-[7px] px-4",children:"Дешевле"}),(0,i.jsx)("div",{"data-value":"price_desc",className:"bg-white w-full h-10 pt-[7px] px-4",children:"Дороже"})]})})]}),(0,i.jsxs)("div",{style:{left:T?"0":"-100%"},className:"h-[100dvh] fixed transition-all linear duration-[250ms] top-0 w-screenSmart flex flex-col p-6 gap-6 bg-white z-10\n				800:h-auto 800:static 800:w-full 800:px-6 px-4\n				",children:[(0,i.jsxs)("div",{onClick:()=>{z(()=>!1)},className:"800:w-fit 800:h-fit 800:cursor-auto relative        w-full h-[70px] flex items-center justify-center cursor-pointer",children:[(0,i.jsx)("h2",{className:"text-[22px] font-semibold leading-8",children:"Фильтры"}),(0,i.jsx)("div",{className:"absolute left-0 block 800:hidden z-10 w-fit h-fit",children:(0,i.jsx)(r.A,{src:C,width:20,height:20})})]}),(0,i.jsxs)("div",{className:"flex flex-col w-full h-full 800:h-auto gap-4 max-h-full relative",children:[(0,i.jsx)(x,{name:"Цена",children:(0,i.jsx)(j,{placeholder:"₽",value:[W.minPrice,W.maxPrice],onChange:e=>{M(e,"price")},min:(null==(t=e.filters.priceRange)?void 0:t.min)||0,max:(null==(a=e.filters.priceRange)?void 0:a.max)||100})}),e.filters.features?(0,i.jsx)(x,{name:"Особенности",children:Object.entries(e.filters.features).map(e=>{let[t,a]=e;return(0,i.jsx)(p,{active:!!W.features&&W.features.includes(t),onCheck:e=>{M({name:t,value:e},"features")},name:t,quantity:a},t)})}):"",e.filters.colors?(0,i.jsx)(x,{name:"Цвет",children:Object.entries(e.filters.colors).map(e=>{let[t,a]=e;return(0,i.jsx)(p,{active:!!W.colors&&W.colors.includes(t),onCheck:e=>{M({name:t,value:e},"colors")},name:t,quantity:a},t)})}):"",e.filters.materials?(0,i.jsx)(x,{name:"Материал",children:Object.entries(e.filters.materials).map(e=>{let[t,a]=e;return(0,i.jsx)(p,{active:!!W.material&&W.material.includes(t),name:t,onCheck:e=>{M({name:t,value:e},"material")},quantity:a},t)})}):"",(0,i.jsx)(x,{name:"Размеры",maxHeight:600,children:(0,i.jsxs)("div",{className:"w-full pl-3 flex flex-col gap-1",children:[(0,i.jsx)(x,{name:"Высота",children:(0,i.jsx)(j,{value:[W.minHeight,W.maxHeight],placeholder:"мм",onChange:e=>{M(e,"height")},min:(null==(o=e.filters.sizes)||null==(c=o.height)?void 0:c.min)||0,max:(null==(h=e.filters.sizes)||null==(u=h.height)?void 0:u.max)||100})}),(0,i.jsx)(x,{name:"Ширина",children:(0,i.jsx)(j,{value:[W.minWidth,W.maxWidth],placeholder:"мм",onChange:e=>{M(e,"width")},min:(null==(f=e.filters.sizes)||null==(m=f.width)?void 0:m.min)||0,max:(null==(v=e.filters.sizes)||null==(g=v.width)?void 0:g.max)||100})}),(0,i.jsx)(x,{name:"Толщина",children:(0,i.jsx)(j,{value:[W.minThickness,W.maxThickness],placeholder:"мм",onChange:e=>{M(e,"thickness")},min:(null==(b=e.filters.sizes)||null==(w=b.thickness)?void 0:w.min)||0,max:(null==(_=e.filters.sizes)||null==(N=_.thickness)?void 0:N.max)||100})})]})}),(0,i.jsxs)("div",{className:"absolute bottom-0 flex flex-col gap-4 w-full 800:hidden",children:[(0,i.jsx)(l.A,{onClick:()=>{z(()=>!1)},className:"w-full h-[50px]",children:"Показать"}),(0,i.jsx)(l.A,{onClick:()=>{B(),z(()=>!1)},className:"bg-white border-1 border-light-blue text-black! w-full",children:"Сбросить фильтры"})]})]})]}),(0,i.jsxs)("div",{className:"w-full h-auto flex flex-col gap-[30px]",children:[(0,i.jsx)("div",{className:"grid auto-rows-min       1500:grid-cols-4       1300:gap-x-[30px] 1300:gap-y-10       1100:grid-cols-3 gap-x-[15px] gap-y-5       550:grid-cols-2       grid-cols-1",children:A.map(t=>(0,i.jsx)(H(),{href:"/catalog/".concat(e.cid,"/").concat(t._id),children:(0,i.jsx)(k,{product:t})},t._id))}),(0,i.jsx)("div",{className:"w-full h-auto flex justify-center",children:(0,i.jsx)(y.A,{page:parseInt(W.page)||1,onChange:function(e,t){M({page:t},"page")},count:F,shape:"rounded",variant:"text",color:"primary",size:"large"})})]})]})}},4818:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,1356,23)),Promise.resolve().then(a.bind(a,1731)),Promise.resolve().then(a.bind(a,7944)),Promise.resolve().then(a.bind(a,3325)),Promise.resolve().then(a.bind(a,8987))}},e=>{e.O(0,[356,481,276,139,397,313,984,441,255,358],()=>e(e.s=4818)),_N_E=e.O()}]);